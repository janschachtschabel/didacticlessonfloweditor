import{r as Ae,a as Ue,b as Ye,d as ze,e as We,f as Xe,h as He,i as Je,j as Ze,k as Ke,l as Qe,m as er,n as rr,o as nr,p as ar,q as ir,s as tr,t as or,u as ur,v as dr,w as sr,x as fr,y as cr,z as hr,A as lr,B as vr,g as pr}from"./lodash-Bbz3qfAa.js";import{r as mr}from"./vendor-graph-AX3sTKNp.js";function be(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var V;if(typeof be=="function")try{V=mr()}catch{}V||(V=window.graphlib);var k=V,D;if(typeof be=="function")try{D={cloneDeep:Ae(),constant:Ue(),defaults:Ye(),each:ze(),filter:We(),find:Xe(),flatten:He(),forEach:Je(),forIn:Ze(),has:Ke(),isUndefined:Qe(),last:er(),map:rr(),mapValues:nr(),max:ar(),merge:ir(),min:tr(),minBy:or(),now:ur(),pick:dr(),range:sr(),reduce:fr(),sortBy:cr(),uniqueId:hr(),values:lr(),zipObject:vr()}}catch{}D||(D=window._);var b=D,wr=U;function U(){var e={};e._next=e._prev=e,this._sentinel=e}U.prototype.dequeue=function(){var e=this._sentinel,r=e._prev;if(r!==e)return Ee(r),r};U.prototype.enqueue=function(e){var r=this._sentinel;e._prev&&e._next&&Ee(e),e._next=r._next,r._next._prev=e,r._next=e,e._prev=r};U.prototype.toString=function(){for(var e=[],r=this._sentinel,n=r._prev;n!==r;)e.push(JSON.stringify(n,br)),n=n._prev;return"["+e.join(", ")+"]"};function Ee(e){e._prev._next=e._next,e._next._prev=e._prev,delete e._next,delete e._prev}function br(e,r){if(e!=="_next"&&e!=="_prev")return r}var N=b,Er=k.Graph,gr=wr,yr=xr,kr=N.constant(1);function xr(e,r){if(e.nodeCount()<=1)return[];var n=Nr(e,r||kr),a=_r(n.graph,n.buckets,n.zeroIdx);return N.flatten(N.map(a,function(i){return e.outEdges(i.v,i.w)}),!0)}function _r(e,r,n){for(var a=[],i=r[r.length-1],o=r[0],t;e.nodeCount();){for(;t=o.dequeue();)z(e,r,n,t);for(;t=i.dequeue();)z(e,r,n,t);if(e.nodeCount()){for(var u=r.length-2;u>0;--u)if(t=r[u].dequeue(),t){a=a.concat(z(e,r,n,t,!0));break}}}return a}function z(e,r,n,a,i){var o=i?[]:void 0;return N.forEach(e.inEdges(a.v),function(t){var u=e.edge(t),d=e.node(t.v);i&&o.push({v:t.v,w:t.w}),d.out-=u,K(r,n,d)}),N.forEach(e.outEdges(a.v),function(t){var u=e.edge(t),d=t.w,s=e.node(d);s.in-=u,K(r,n,s)}),e.removeNode(a.v),o}function Nr(e,r){var n=new Er,a=0,i=0;N.forEach(e.nodes(),function(u){n.setNode(u,{v:u,in:0,out:0})}),N.forEach(e.edges(),function(u){var d=n.edge(u.v,u.w)||0,s=r(u),f=d+s;n.setEdge(u.v,u.w,f),i=Math.max(i,n.node(u.v).out+=s),a=Math.max(a,n.node(u.w).in+=s)});var o=N.range(i+a+3).map(function(){return new gr}),t=a+1;return N.forEach(n.nodes(),function(u){K(o,t,n.node(u))}),{graph:n,buckets:o,zeroIdx:t}}function K(e,r,n){n.out?n.in?e[n.out-n.in+r].enqueue(n):e[e.length-1].enqueue(n):e[0].enqueue(n)}var M=b,$r=yr,Lr={run:Cr,undo:Ir};function Cr(e){var r=e.graph().acyclicer==="greedy"?$r(e,n(e)):Rr(e);M.forEach(r,function(a){var i=e.edge(a);e.removeEdge(a),i.forwardName=a.name,i.reversed=!0,e.setEdge(a.w,a.v,i,M.uniqueId("rev"))});function n(a){return function(i){return a.edge(i).weight}}}function Rr(e){var r=[],n={},a={};function i(o){M.has(a,o)||(a[o]=!0,n[o]=!0,M.forEach(e.outEdges(o),function(t){M.has(n,t.w)?r.push(t):i(t.w)}),delete n[o])}return M.forEach(e.nodes(),i),r}function Ir(e){M.forEach(e.edges(),function(r){var n=e.edge(r);if(n.reversed){e.removeEdge(r);var a=n.forwardName;delete n.reversed,delete n.forwardName,e.setEdge(r.w,r.v,n,a)}})}var p=b,ge=k.Graph,g={addDummyNode:ye,simplify:qr,asNonCompoundGraph:Mr,successorWeights:Tr,predecessorWeights:Sr,intersectRect:Gr,buildLayerMatrix:Pr,normalizeRanks:Br,removeEmptyRanks:Or,addBorderNode:Fr,maxRank:ke,partition:Vr,time:Dr,notime:jr};function ye(e,r,n,a){var i;do i=p.uniqueId(a);while(e.hasNode(i));return n.dummy=r,e.setNode(i,n),i}function qr(e){var r=new ge().setGraph(e.graph());return p.forEach(e.nodes(),function(n){r.setNode(n,e.node(n))}),p.forEach(e.edges(),function(n){var a=r.edge(n.v,n.w)||{weight:0,minlen:1},i=e.edge(n);r.setEdge(n.v,n.w,{weight:a.weight+i.weight,minlen:Math.max(a.minlen,i.minlen)})}),r}function Mr(e){var r=new ge({multigraph:e.isMultigraph()}).setGraph(e.graph());return p.forEach(e.nodes(),function(n){e.children(n).length||r.setNode(n,e.node(n))}),p.forEach(e.edges(),function(n){r.setEdge(n,e.edge(n))}),r}function Tr(e){var r=p.map(e.nodes(),function(n){var a={};return p.forEach(e.outEdges(n),function(i){a[i.w]=(a[i.w]||0)+e.edge(i).weight}),a});return p.zipObject(e.nodes(),r)}function Sr(e){var r=p.map(e.nodes(),function(n){var a={};return p.forEach(e.inEdges(n),function(i){a[i.v]=(a[i.v]||0)+e.edge(i).weight}),a});return p.zipObject(e.nodes(),r)}function Gr(e,r){var n=e.x,a=e.y,i=r.x-n,o=r.y-a,t=e.width/2,u=e.height/2;if(!i&&!o)throw new Error("Not possible to find intersection inside of the rectangle");var d,s;return Math.abs(o)*t>Math.abs(i)*u?(o<0&&(u=-u),d=u*i/o,s=u):(i<0&&(t=-t),d=t,s=t*o/i),{x:n+d,y:a+s}}function Pr(e){var r=p.map(p.range(ke(e)+1),function(){return[]});return p.forEach(e.nodes(),function(n){var a=e.node(n),i=a.rank;p.isUndefined(i)||(r[i][a.order]=n)}),r}function Br(e){var r=p.min(p.map(e.nodes(),function(n){return e.node(n).rank}));p.forEach(e.nodes(),function(n){var a=e.node(n);p.has(a,"rank")&&(a.rank-=r)})}function Or(e){var r=p.min(p.map(e.nodes(),function(o){return e.node(o).rank})),n=[];p.forEach(e.nodes(),function(o){var t=e.node(o).rank-r;n[t]||(n[t]=[]),n[t].push(o)});var a=0,i=e.graph().nodeRankFactor;p.forEach(n,function(o,t){p.isUndefined(o)&&t%i!==0?--a:a&&p.forEach(o,function(u){e.node(u).rank+=a})})}function Fr(e,r,n,a){var i={width:0,height:0};return arguments.length>=4&&(i.rank=n,i.order=a),ye(e,"border",i,r)}function ke(e){return p.max(p.map(e.nodes(),function(r){var n=e.node(r).rank;if(!p.isUndefined(n))return n}))}function Vr(e,r){var n={lhs:[],rhs:[]};return p.forEach(e,function(a){r(a)?n.lhs.push(a):n.rhs.push(a)}),n}function Dr(e,r){var n=p.now();try{return r()}finally{console.log(e+" time: "+(p.now()-n)+"ms")}}function jr(e,r){return r()}var xe=b,Ar=g,Ur={run:Yr,undo:Wr};function Yr(e){e.graph().dummyChains=[],xe.forEach(e.edges(),function(r){zr(e,r)})}function zr(e,r){var n=r.v,a=e.node(n).rank,i=r.w,o=e.node(i).rank,t=r.name,u=e.edge(r),d=u.labelRank;if(o!==a+1){e.removeEdge(r);var s,f,c;for(c=0,++a;a<o;++c,++a)u.points=[],f={width:0,height:0,edgeLabel:u,edgeObj:r,rank:a},s=Ar.addDummyNode(e,"edge",f,"_d"),a===d&&(f.width=u.width,f.height=u.height,f.dummy="edge-label",f.labelpos=u.labelpos),e.setEdge(n,s,{weight:u.weight},t),c===0&&e.graph().dummyChains.push(s),n=s;e.setEdge(n,i,{weight:u.weight},t)}}function Wr(e){xe.forEach(e.graph().dummyChains,function(r){var n=e.node(r),a=n.edgeLabel,i;for(e.setEdge(n.edgeObj,a);n.dummy;)i=e.successors(r)[0],e.removeNode(r),a.points.push({x:n.x,y:n.y}),n.dummy==="edge-label"&&(a.x=n.x,a.y=n.y,a.width=n.width,a.height=n.height),r=i,n=e.node(r)})}var O=b,Y={longestPath:Xr,slack:Hr};function Xr(e){var r={};function n(a){var i=e.node(a);if(O.has(r,a))return i.rank;r[a]=!0;var o=O.min(O.map(e.outEdges(a),function(t){return n(t.w)-e.edge(t).minlen}));return(o===Number.POSITIVE_INFINITY||o===void 0||o===null)&&(o=0),i.rank=o}O.forEach(e.sources(),n)}function Hr(e,r){return e.node(r.w).rank-e.node(r.v).rank-e.edge(r).minlen}var j=b,Jr=k.Graph,A=Y.slack,_e=Zr;function Zr(e){var r=new Jr({directed:!1}),n=e.nodes()[0],a=e.nodeCount();r.setNode(n,{});for(var i,o;Kr(r,e)<a;)i=Qr(r,e),o=r.hasNode(i.v)?A(e,i):-A(e,i),en(r,e,o);return r}function Kr(e,r){function n(a){j.forEach(r.nodeEdges(a),function(i){var o=i.v,t=a===o?i.w:o;!e.hasNode(t)&&!A(r,i)&&(e.setNode(t,{}),e.setEdge(a,t,{}),n(t))})}return j.forEach(e.nodes(),n),e.nodeCount()}function Qr(e,r){return j.minBy(r.edges(),function(n){if(e.hasNode(n.v)!==e.hasNode(n.w))return A(r,n)})}function en(e,r,n){j.forEach(e.nodes(),function(a){r.node(a).rank+=n})}var L=b,rn=_e,nn=Y.slack,an=Y.longestPath,tn=k.alg.preorder,on=k.alg.postorder,un=g.simplify,dn=T;T.initLowLimValues=ne;T.initCutValues=re;T.calcCutValue=Ne;T.leaveEdge=Le;T.enterEdge=Ce;T.exchangeEdges=Re;function T(e){e=un(e),an(e);var r=rn(e);ne(r),re(r,e);for(var n,a;n=Le(r);)a=Ce(r,e,n),Re(r,e,n,a)}function re(e,r){var n=on(e,e.nodes());n=n.slice(0,n.length-1),L.forEach(n,function(a){sn(e,r,a)})}function sn(e,r,n){var a=e.node(n),i=a.parent;e.edge(n,i).cutvalue=Ne(e,r,n)}function Ne(e,r,n){var a=e.node(n),i=a.parent,o=!0,t=r.edge(n,i),u=0;return t||(o=!1,t=r.edge(i,n)),u=t.weight,L.forEach(r.nodeEdges(n),function(d){var s=d.v===n,f=s?d.w:d.v;if(f!==i){var c=s===o,v=r.edge(d).weight;if(u+=c?v:-v,cn(e,n,f)){var m=e.edge(n,f).cutvalue;u+=c?-m:m}}}),u}function ne(e,r){arguments.length<2&&(r=e.nodes()[0]),$e(e,{},1,r)}function $e(e,r,n,a,i){var o=n,t=e.node(a);return r[a]=!0,L.forEach(e.neighbors(a),function(u){L.has(r,u)||(n=$e(e,r,n,u,a))}),t.low=o,t.lim=n++,i?t.parent=i:delete t.parent,n}function Le(e){return L.find(e.edges(),function(r){return e.edge(r).cutvalue<0})}function Ce(e,r,n){var a=n.v,i=n.w;r.hasEdge(a,i)||(a=n.w,i=n.v);var o=e.node(a),t=e.node(i),u=o,d=!1;o.lim>t.lim&&(u=t,d=!0);var s=L.filter(r.edges(),function(f){return d===te(e,e.node(f.v),u)&&d!==te(e,e.node(f.w),u)});return L.minBy(s,function(f){return nn(r,f)})}function Re(e,r,n,a){var i=n.v,o=n.w;e.removeEdge(i,o),e.setEdge(a.v,a.w,{}),ne(e),re(e,r),fn(e,r)}function fn(e,r){var n=L.find(e.nodes(),function(i){return!r.node(i).parent}),a=tn(e,n);a=a.slice(1),L.forEach(a,function(i){var o=e.node(i).parent,t=r.edge(i,o),u=!1;t||(t=r.edge(o,i),u=!0),r.node(i).rank=r.node(o).rank+(u?t.minlen:-t.minlen)})}function cn(e,r,n){return e.hasEdge(r,n)}function te(e,r,n){return n.low<=r.lim&&r.lim<=n.lim}var hn=Y,Ie=hn.longestPath,ln=_e,vn=dn,pn=mn;function mn(e){switch(e.graph().ranker){case"network-simplex":oe(e);break;case"tight-tree":bn(e);break;case"longest-path":wn(e);break;default:oe(e)}}var wn=Ie;function bn(e){Ie(e),ln(e)}function oe(e){vn(e)}var Q=b,En=gn;function gn(e){var r=kn(e);Q.forEach(e.graph().dummyChains,function(n){for(var a=e.node(n),i=a.edgeObj,o=yn(e,r,i.v,i.w),t=o.path,u=o.lca,d=0,s=t[d],f=!0;n!==i.w;){if(a=e.node(n),f){for(;(s=t[d])!==u&&e.node(s).maxRank<a.rank;)d++;s===u&&(f=!1)}if(!f){for(;d<t.length-1&&e.node(s=t[d+1]).minRank<=a.rank;)d++;s=t[d]}e.setParent(n,s),n=e.successors(n)[0]}})}function yn(e,r,n,a){var i=[],o=[],t=Math.min(r[n].low,r[a].low),u=Math.max(r[n].lim,r[a].lim),d,s;d=n;do d=e.parent(d),i.push(d);while(d&&(r[d].low>t||u>r[d].lim));for(s=d,d=a;(d=e.parent(d))!==s;)o.push(d);return{path:i.concat(o.reverse()),lca:s}}function kn(e){var r={},n=0;function a(i){var o=n;Q.forEach(e.children(i),a),r[i]={low:o,lim:n++}}return Q.forEach(e.children(),a),r}var $=b,ee=g,xn={run:_n,cleanup:Ln};function _n(e){var r=ee.addDummyNode(e,"root",{},"_root"),n=Nn(e),a=$.max($.values(n))-1,i=2*a+1;e.graph().nestingRoot=r,$.forEach(e.edges(),function(t){e.edge(t).minlen*=i});var o=$n(e)+1;$.forEach(e.children(),function(t){qe(e,r,i,o,a,n,t)}),e.graph().nodeRankFactor=i}function qe(e,r,n,a,i,o,t){var u=e.children(t);if(!u.length){t!==r&&e.setEdge(r,t,{weight:0,minlen:n});return}var d=ee.addBorderNode(e,"_bt"),s=ee.addBorderNode(e,"_bb"),f=e.node(t);e.setParent(d,t),f.borderTop=d,e.setParent(s,t),f.borderBottom=s,$.forEach(u,function(c){qe(e,r,n,a,i,o,c);var v=e.node(c),m=v.borderTop?v.borderTop:c,w=v.borderBottom?v.borderBottom:c,E=v.borderTop?a:2*a,S=m!==w?1:i-o[t]+1;e.setEdge(d,m,{weight:E,minlen:S,nestingEdge:!0}),e.setEdge(w,s,{weight:E,minlen:S,nestingEdge:!0})}),e.parent(t)||e.setEdge(r,d,{weight:0,minlen:i+o[t]})}function Nn(e){var r={};function n(a,i){var o=e.children(a);o&&o.length&&$.forEach(o,function(t){n(t,i+1)}),r[a]=i}return $.forEach(e.children(),function(a){n(a,1)}),r}function $n(e){return $.reduce(e.edges(),function(r,n){return r+e.edge(n).weight},0)}function Ln(e){var r=e.graph();e.removeNode(r.nestingRoot),delete r.nestingRoot,$.forEach(e.edges(),function(n){var a=e.edge(n);a.nestingEdge&&e.removeEdge(n)})}var W=b,Cn=g,Rn=In;function In(e){function r(n){var a=e.children(n),i=e.node(n);if(a.length&&W.forEach(a,r),W.has(i,"minRank")){i.borderLeft=[],i.borderRight=[];for(var o=i.minRank,t=i.maxRank+1;o<t;++o)ue(e,"borderLeft","_bl",n,i,o),ue(e,"borderRight","_br",n,i,o)}}W.forEach(e.children(),r)}function ue(e,r,n,a,i,o){var t={width:0,height:0,rank:o,borderType:r},u=i[r][o-1],d=Cn.addDummyNode(e,"border",t,n);i[r][o]=d,e.setParent(d,a),u&&e.setEdge(u,d,{weight:1})}var x=b,qn={adjust:Mn,undo:Tn};function Mn(e){var r=e.graph().rankdir.toLowerCase();(r==="lr"||r==="rl")&&Me(e)}function Tn(e){var r=e.graph().rankdir.toLowerCase();(r==="bt"||r==="rl")&&Sn(e),(r==="lr"||r==="rl")&&(Gn(e),Me(e))}function Me(e){x.forEach(e.nodes(),function(r){de(e.node(r))}),x.forEach(e.edges(),function(r){de(e.edge(r))})}function de(e){var r=e.width;e.width=e.height,e.height=r}function Sn(e){x.forEach(e.nodes(),function(r){X(e.node(r))}),x.forEach(e.edges(),function(r){var n=e.edge(r);x.forEach(n.points,X),x.has(n,"y")&&X(n)})}function X(e){e.y=-e.y}function Gn(e){x.forEach(e.nodes(),function(r){H(e.node(r))}),x.forEach(e.edges(),function(r){var n=e.edge(r);x.forEach(n.points,H),x.has(n,"x")&&H(n)})}function H(e){var r=e.x;e.x=e.y,e.y=r}var _=b,Pn=Bn;function Bn(e){var r={},n=_.filter(e.nodes(),function(u){return!e.children(u).length}),a=_.max(_.map(n,function(u){return e.node(u).rank})),i=_.map(_.range(a+1),function(){return[]});function o(u){if(!_.has(r,u)){r[u]=!0;var d=e.node(u);i[d.rank].push(u),_.forEach(e.successors(u),o)}}var t=_.sortBy(n,function(u){return e.node(u).rank});return _.forEach(t,o),i}var C=b,On=Fn;function Fn(e,r){for(var n=0,a=1;a<r.length;++a)n+=Vn(e,r[a-1],r[a]);return n}function Vn(e,r,n){for(var a=C.zipObject(n,C.map(n,function(s,f){return f})),i=C.flatten(C.map(r,function(s){return C.sortBy(C.map(e.outEdges(s),function(f){return{pos:a[f.w],weight:e.edge(f).weight}}),"pos")}),!0),o=1;o<n.length;)o<<=1;var t=2*o-1;o-=1;var u=C.map(new Array(t),function(){return 0}),d=0;return C.forEach(i.forEach(function(s){var f=s.pos+o;u[f]+=s.weight;for(var c=0;f>0;)f%2&&(c+=u[f+1]),f=f-1>>1,u[f]+=s.weight;d+=s.weight*c})),d}var se=b,Dn=jn;function jn(e,r){return se.map(r,function(n){var a=e.inEdges(n);if(a.length){var i=se.reduce(a,function(o,t){var u=e.edge(t),d=e.node(t.v);return{sum:o.sum+u.weight*d.order,weight:o.weight+u.weight}},{sum:0,weight:0});return{v:n,barycenter:i.sum/i.weight,weight:i.weight}}else return{v:n}})}var y=b,An=Un;function Un(e,r){var n={};y.forEach(e,function(i,o){var t=n[i.v]={indegree:0,in:[],out:[],vs:[i.v],i:o};y.isUndefined(i.barycenter)||(t.barycenter=i.barycenter,t.weight=i.weight)}),y.forEach(r.edges(),function(i){var o=n[i.v],t=n[i.w];!y.isUndefined(o)&&!y.isUndefined(t)&&(t.indegree++,o.out.push(n[i.w]))});var a=y.filter(n,function(i){return!i.indegree});return Yn(a)}function Yn(e){var r=[];function n(o){return function(t){t.merged||(y.isUndefined(t.barycenter)||y.isUndefined(o.barycenter)||t.barycenter>=o.barycenter)&&zn(o,t)}}function a(o){return function(t){t.in.push(o),--t.indegree===0&&e.push(t)}}for(;e.length;){var i=e.pop();r.push(i),y.forEach(i.in.reverse(),n(i)),y.forEach(i.out,a(i))}return y.map(y.filter(r,function(o){return!o.merged}),function(o){return y.pick(o,["vs","i","barycenter","weight"])})}function zn(e,r){var n=0,a=0;e.weight&&(n+=e.barycenter*e.weight,a+=e.weight),r.weight&&(n+=r.barycenter*r.weight,a+=r.weight),e.vs=r.vs.concat(e.vs),e.barycenter=n/a,e.weight=a,e.i=Math.min(r.i,e.i),r.merged=!0}var G=b,Wn=g,Xn=Hn;function Hn(e,r){var n=Wn.partition(e,function(f){return G.has(f,"barycenter")}),a=n.lhs,i=G.sortBy(n.rhs,function(f){return-f.i}),o=[],t=0,u=0,d=0;a.sort(Jn(!!r)),d=fe(o,i,d),G.forEach(a,function(f){d+=f.vs.length,o.push(f.vs),t+=f.barycenter*f.weight,u+=f.weight,d=fe(o,i,d)});var s={vs:G.flatten(o,!0)};return u&&(s.barycenter=t/u,s.weight=u),s}function fe(e,r,n){for(var a;r.length&&(a=G.last(r)).i<=n;)r.pop(),e.push(a.vs),n++;return n}function Jn(e){return function(r,n){return r.barycenter<n.barycenter?-1:r.barycenter>n.barycenter?1:e?n.i-r.i:r.i-n.i}}var R=b,Zn=Dn,Kn=An,Qn=Xn,ea=Te;function Te(e,r,n,a){var i=e.children(r),o=e.node(r),t=o?o.borderLeft:void 0,u=o?o.borderRight:void 0,d={};t&&(i=R.filter(i,function(w){return w!==t&&w!==u}));var s=Zn(e,i);R.forEach(s,function(w){if(e.children(w.v).length){var E=Te(e,w.v,n,a);d[w.v]=E,R.has(E,"barycenter")&&na(w,E)}});var f=Kn(s,n);ra(f,d);var c=Qn(f,a);if(t&&(c.vs=R.flatten([t,c.vs,u],!0),e.predecessors(t).length)){var v=e.node(e.predecessors(t)[0]),m=e.node(e.predecessors(u)[0]);R.has(c,"barycenter")||(c.barycenter=0,c.weight=0),c.barycenter=(c.barycenter*c.weight+v.order+m.order)/(c.weight+2),c.weight+=2}return c}function ra(e,r){R.forEach(e,function(n){n.vs=R.flatten(n.vs.map(function(a){return r[a]?r[a].vs:a}),!0)})}function na(e,r){R.isUndefined(e.barycenter)?(e.barycenter=r.barycenter,e.weight=r.weight):(e.barycenter=(e.barycenter*e.weight+r.barycenter*r.weight)/(e.weight+r.weight),e.weight+=r.weight)}var P=b,aa=k.Graph,ia=ta;function ta(e,r,n){var a=oa(e),i=new aa({compound:!0}).setGraph({root:a}).setDefaultNodeLabel(function(o){return e.node(o)});return P.forEach(e.nodes(),function(o){var t=e.node(o),u=e.parent(o);(t.rank===r||t.minRank<=r&&r<=t.maxRank)&&(i.setNode(o),i.setParent(o,u||a),P.forEach(e[n](o),function(d){var s=d.v===o?d.w:d.v,f=i.edge(s,o),c=P.isUndefined(f)?0:f.weight;i.setEdge(s,o,{weight:e.edge(d).weight+c})}),P.has(t,"minRank")&&i.setNode(o,{borderLeft:t.borderLeft[r],borderRight:t.borderRight[r]}))}),i}function oa(e){for(var r;e.hasNode(r=P.uniqueId("_root")););return r}var ua=b,da=sa;function sa(e,r,n){var a={},i;ua.forEach(n,function(o){for(var t=e.parent(o),u,d;t;){if(u=e.parent(t),u?(d=a[u],a[u]=t):(d=i,i=t),d&&d!==t){r.setEdge(d,t);return}t=u}})}var I=b,fa=Pn,ca=On,ha=ea,la=ia,va=da,pa=k.Graph,ce=g,ma=wa;function wa(e){var r=ce.maxRank(e),n=he(e,I.range(1,r+1),"inEdges"),a=he(e,I.range(r-1,-1,-1),"outEdges"),i=fa(e);le(e,i);for(var o=Number.POSITIVE_INFINITY,t,u=0,d=0;d<4;++u,++d){ba(u%2?n:a,u%4>=2),i=ce.buildLayerMatrix(e);var s=ca(e,i);s<o&&(d=0,t=I.cloneDeep(i),o=s)}le(e,t)}function he(e,r,n){return I.map(r,function(a){return la(e,a,n)})}function ba(e,r){var n=new pa;I.forEach(e,function(a){var i=a.graph().root,o=ha(a,i,n,r);I.forEach(o.vs,function(t,u){a.node(t).order=u}),va(a,n,o.vs)})}function le(e,r){I.forEach(r,function(n){I.forEach(n,function(a,i){e.node(a).order=i})})}var h=b,Ea=k.Graph,ga=g,ya={positionX:_a,findType1Conflicts:Se,findType2Conflicts:Ge,addConflict:ae,hasConflict:Pe,verticalAlignment:Be,horizontalCompaction:Oe,alignCoordinates:Ve,findSmallestWidthAlignment:Fe,balance:De};function Se(e,r){var n={};function a(i,o){var t=0,u=0,d=i.length,s=h.last(o);return h.forEach(o,function(f,c){var v=ka(e,f),m=v?e.node(v).order:d;(v||f===s)&&(h.forEach(o.slice(u,c+1),function(w){h.forEach(e.predecessors(w),function(E){var S=e.node(E),ie=S.order;(ie<t||m<ie)&&!(S.dummy&&e.node(w).dummy)&&ae(n,E,w)})}),u=c+1,t=m)}),o}return h.reduce(r,a),n}function Ge(e,r){var n={};function a(o,t,u,d,s){var f;h.forEach(h.range(t,u),function(c){f=o[c],e.node(f).dummy&&h.forEach(e.predecessors(f),function(v){var m=e.node(v);m.dummy&&(m.order<d||m.order>s)&&ae(n,v,f)})})}function i(o,t){var u=-1,d,s=0;return h.forEach(t,function(f,c){if(e.node(f).dummy==="border"){var v=e.predecessors(f);v.length&&(d=e.node(v[0]).order,a(t,s,c,u,d),s=c,u=d)}a(t,s,t.length,d,o.length)}),t}return h.reduce(r,i),n}function ka(e,r){if(e.node(r).dummy)return h.find(e.predecessors(r),function(n){return e.node(n).dummy})}function ae(e,r,n){if(r>n){var a=r;r=n,n=a}var i=e[r];i||(e[r]=i={}),i[n]=!0}function Pe(e,r,n){if(r>n){var a=r;r=n,n=a}return h.has(e[r],n)}function Be(e,r,n,a){var i={},o={},t={};return h.forEach(r,function(u){h.forEach(u,function(d,s){i[d]=d,o[d]=d,t[d]=s})}),h.forEach(r,function(u){var d=-1;h.forEach(u,function(s){var f=a(s);if(f.length){f=h.sortBy(f,function(E){return t[E]});for(var c=(f.length-1)/2,v=Math.floor(c),m=Math.ceil(c);v<=m;++v){var w=f[v];o[s]===s&&d<t[w]&&!Pe(n,s,w)&&(o[w]=s,o[s]=i[s]=i[w],d=t[w])}}})}),{root:i,align:o}}function Oe(e,r,n,a,i){var o={},t=xa(e,r,n,i),u=i?"borderLeft":"borderRight";function d(c,v){for(var m=t.nodes(),w=m.pop(),E={};w;)E[w]?c(w):(E[w]=!0,m.push(w),m=m.concat(v(w))),w=m.pop()}function s(c){o[c]=t.inEdges(c).reduce(function(v,m){return Math.max(v,o[m.v]+t.edge(m))},0)}function f(c){var v=t.outEdges(c).reduce(function(w,E){return Math.min(w,o[E.w]-t.edge(E))},Number.POSITIVE_INFINITY),m=e.node(c);v!==Number.POSITIVE_INFINITY&&m.borderType!==u&&(o[c]=Math.max(o[c],v))}return d(s,t.predecessors.bind(t)),d(f,t.successors.bind(t)),h.forEach(a,function(c){o[c]=o[n[c]]}),o}function xa(e,r,n,a){var i=new Ea,o=e.graph(),t=Na(o.nodesep,o.edgesep,a);return h.forEach(r,function(u){var d;h.forEach(u,function(s){var f=n[s];if(i.setNode(f),d){var c=n[d],v=i.edge(c,f);i.setEdge(c,f,Math.max(t(e,s,d),v||0))}d=s})}),i}function Fe(e,r){return h.minBy(h.values(r),function(n){var a=Number.NEGATIVE_INFINITY,i=Number.POSITIVE_INFINITY;return h.forIn(n,function(o,t){var u=$a(e,t)/2;a=Math.max(o+u,a),i=Math.min(o-u,i)}),a-i})}function Ve(e,r){var n=h.values(r),a=h.min(n),i=h.max(n);h.forEach(["u","d"],function(o){h.forEach(["l","r"],function(t){var u=o+t,d=e[u],s;if(d!==r){var f=h.values(d);s=t==="l"?a-h.min(f):i-h.max(f),s&&(e[u]=h.mapValues(d,function(c){return c+s}))}})})}function De(e,r){return h.mapValues(e.ul,function(n,a){if(r)return e[r.toLowerCase()][a];var i=h.sortBy(h.map(e,a));return(i[1]+i[2])/2})}function _a(e){var r=ga.buildLayerMatrix(e),n=h.merge(Se(e,r),Ge(e,r)),a={},i;h.forEach(["u","d"],function(t){i=t==="u"?r:h.values(r).reverse(),h.forEach(["l","r"],function(u){u==="r"&&(i=h.map(i,function(c){return h.values(c).reverse()}));var d=(t==="u"?e.predecessors:e.successors).bind(e),s=Be(e,i,n,d),f=Oe(e,i,s.root,s.align,u==="r");u==="r"&&(f=h.mapValues(f,function(c){return-c})),a[t+u]=f})});var o=Fe(e,a);return Ve(a,o),De(a,e.graph().align)}function Na(e,r,n){return function(a,i,o){var t=a.node(i),u=a.node(o),d=0,s;if(d+=t.width/2,h.has(t,"labelpos"))switch(t.labelpos.toLowerCase()){case"l":s=-t.width/2;break;case"r":s=t.width/2;break}if(s&&(d+=n?s:-s),s=0,d+=(t.dummy?r:e)/2,d+=(u.dummy?r:e)/2,d+=u.width/2,h.has(u,"labelpos"))switch(u.labelpos.toLowerCase()){case"l":s=u.width/2;break;case"r":s=-u.width/2;break}return s&&(d+=n?s:-s),s=0,d}}function $a(e,r){return e.node(r).width}var B=b,je=g,La=ya.positionX,Ca=Ra;function Ra(e){e=je.asNonCompoundGraph(e),Ia(e),B.forEach(La(e),function(r,n){e.node(n).x=r})}function Ia(e){var r=je.buildLayerMatrix(e),n=e.graph().ranksep,a=0;B.forEach(r,function(i){var o=B.max(B.map(i,function(t){return e.node(t).height}));B.forEach(i,function(t){e.node(t).y=a+o/2}),a+=o+n})}var l=b,ve=Lr,pe=Ur,qa=pn,Ma=g.normalizeRanks,Ta=En,Sa=g.removeEmptyRanks,me=xn,Ga=Rn,we=qn,Pa=ma,Ba=Ca,q=g,Oa=k.Graph,Fa=Va;function Va(e,r){var n=r&&r.debugTiming?q.time:q.notime;n("layout",function(){var a=n("  buildLayoutGraph",function(){return Za(e)});n("  runLayout",function(){Da(a,n)}),n("  updateInputGraph",function(){ja(e,a)})})}function Da(e,r){r("    makeSpaceForEdgeLabels",function(){Ka(e)}),r("    removeSelfEdges",function(){ui(e)}),r("    acyclic",function(){ve.run(e)}),r("    nestingGraph.run",function(){me.run(e)}),r("    rank",function(){qa(q.asNonCompoundGraph(e))}),r("    injectEdgeLabelProxies",function(){Qa(e)}),r("    removeEmptyRanks",function(){Sa(e)}),r("    nestingGraph.cleanup",function(){me.cleanup(e)}),r("    normalizeRanks",function(){Ma(e)}),r("    assignRankMinMax",function(){ei(e)}),r("    removeEdgeLabelProxies",function(){ri(e)}),r("    normalize.run",function(){pe.run(e)}),r("    parentDummyChains",function(){Ta(e)}),r("    addBorderSegments",function(){Ga(e)}),r("    order",function(){Pa(e)}),r("    insertSelfEdges",function(){di(e)}),r("    adjustCoordinateSystem",function(){we.adjust(e)}),r("    position",function(){Ba(e)}),r("    positionSelfEdges",function(){si(e)}),r("    removeBorderNodes",function(){oi(e)}),r("    normalize.undo",function(){pe.undo(e)}),r("    fixupEdgeLabelCoords",function(){ii(e)}),r("    undoCoordinateSystem",function(){we.undo(e)}),r("    translateGraph",function(){ni(e)}),r("    assignNodeIntersects",function(){ai(e)}),r("    reversePoints",function(){ti(e)}),r("    acyclic.undo",function(){ve.undo(e)})}function ja(e,r){l.forEach(e.nodes(),function(n){var a=e.node(n),i=r.node(n);a&&(a.x=i.x,a.y=i.y,r.children(n).length&&(a.width=i.width,a.height=i.height))}),l.forEach(e.edges(),function(n){var a=e.edge(n),i=r.edge(n);a.points=i.points,l.has(i,"x")&&(a.x=i.x,a.y=i.y)}),e.graph().width=r.graph().width,e.graph().height=r.graph().height}var Aa=["nodesep","edgesep","ranksep","marginx","marginy"],Ua={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},Ya=["acyclicer","ranker","rankdir","align"],za=["width","height"],Wa={width:0,height:0},Xa=["minlen","weight","width","height","labeloffset"],Ha={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},Ja=["labelpos"];function Za(e){var r=new Oa({multigraph:!0,compound:!0}),n=Z(e.graph());return r.setGraph(l.merge({},Ua,J(n,Aa),l.pick(n,Ya))),l.forEach(e.nodes(),function(a){var i=Z(e.node(a));r.setNode(a,l.defaults(J(i,za),Wa)),r.setParent(a,e.parent(a))}),l.forEach(e.edges(),function(a){var i=Z(e.edge(a));r.setEdge(a,l.merge({},Ha,J(i,Xa),l.pick(i,Ja)))}),r}function Ka(e){var r=e.graph();r.ranksep/=2,l.forEach(e.edges(),function(n){var a=e.edge(n);a.minlen*=2,a.labelpos.toLowerCase()!=="c"&&(r.rankdir==="TB"||r.rankdir==="BT"?a.width+=a.labeloffset:a.height+=a.labeloffset)})}function Qa(e){l.forEach(e.edges(),function(r){var n=e.edge(r);if(n.width&&n.height){var a=e.node(r.v),i=e.node(r.w),o={rank:(i.rank-a.rank)/2+a.rank,e:r};q.addDummyNode(e,"edge-proxy",o,"_ep")}})}function ei(e){var r=0;l.forEach(e.nodes(),function(n){var a=e.node(n);a.borderTop&&(a.minRank=e.node(a.borderTop).rank,a.maxRank=e.node(a.borderBottom).rank,r=l.max(r,a.maxRank))}),e.graph().maxRank=r}function ri(e){l.forEach(e.nodes(),function(r){var n=e.node(r);n.dummy==="edge-proxy"&&(e.edge(n.e).labelRank=n.rank,e.removeNode(r))})}function ni(e){var r=Number.POSITIVE_INFINITY,n=0,a=Number.POSITIVE_INFINITY,i=0,o=e.graph(),t=o.marginx||0,u=o.marginy||0;function d(s){var f=s.x,c=s.y,v=s.width,m=s.height;r=Math.min(r,f-v/2),n=Math.max(n,f+v/2),a=Math.min(a,c-m/2),i=Math.max(i,c+m/2)}l.forEach(e.nodes(),function(s){d(e.node(s))}),l.forEach(e.edges(),function(s){var f=e.edge(s);l.has(f,"x")&&d(f)}),r-=t,a-=u,l.forEach(e.nodes(),function(s){var f=e.node(s);f.x-=r,f.y-=a}),l.forEach(e.edges(),function(s){var f=e.edge(s);l.forEach(f.points,function(c){c.x-=r,c.y-=a}),l.has(f,"x")&&(f.x-=r),l.has(f,"y")&&(f.y-=a)}),o.width=n-r+t,o.height=i-a+u}function ai(e){l.forEach(e.edges(),function(r){var n=e.edge(r),a=e.node(r.v),i=e.node(r.w),o,t;n.points?(o=n.points[0],t=n.points[n.points.length-1]):(n.points=[],o=i,t=a),n.points.unshift(q.intersectRect(a,o)),n.points.push(q.intersectRect(i,t))})}function ii(e){l.forEach(e.edges(),function(r){var n=e.edge(r);if(l.has(n,"x"))switch((n.labelpos==="l"||n.labelpos==="r")&&(n.width-=n.labeloffset),n.labelpos){case"l":n.x-=n.width/2+n.labeloffset;break;case"r":n.x+=n.width/2+n.labeloffset;break}})}function ti(e){l.forEach(e.edges(),function(r){var n=e.edge(r);n.reversed&&n.points.reverse()})}function oi(e){l.forEach(e.nodes(),function(r){if(e.children(r).length){var n=e.node(r),a=e.node(n.borderTop),i=e.node(n.borderBottom),o=e.node(l.last(n.borderLeft)),t=e.node(l.last(n.borderRight));n.width=Math.abs(t.x-o.x),n.height=Math.abs(i.y-a.y),n.x=o.x+n.width/2,n.y=a.y+n.height/2}}),l.forEach(e.nodes(),function(r){e.node(r).dummy==="border"&&e.removeNode(r)})}function ui(e){l.forEach(e.edges(),function(r){if(r.v===r.w){var n=e.node(r.v);n.selfEdges||(n.selfEdges=[]),n.selfEdges.push({e:r,label:e.edge(r)}),e.removeEdge(r)}})}function di(e){var r=q.buildLayerMatrix(e);l.forEach(r,function(n){var a=0;l.forEach(n,function(i,o){var t=e.node(i);t.order=o+a,l.forEach(t.selfEdges,function(u){q.addDummyNode(e,"selfedge",{width:u.label.width,height:u.label.height,rank:t.rank,order:o+ ++a,e:u.e,label:u.label},"_se")}),delete t.selfEdges})})}function si(e){l.forEach(e.nodes(),function(r){var n=e.node(r);if(n.dummy==="selfedge"){var a=e.node(n.e.v),i=a.x+a.width/2,o=a.y,t=n.x-i,u=a.height/2;e.setEdge(n.e,n.label),e.removeNode(r),n.label.points=[{x:i+2*t/3,y:o-u},{x:i+5*t/6,y:o-u},{x:i+t,y:o},{x:i+5*t/6,y:o+u},{x:i+2*t/3,y:o+u}],n.label.x=n.x,n.label.y=n.y}})}function J(e,r){return l.mapValues(l.pick(e,r),Number)}function Z(e){var r={};return l.forEach(e,function(n,a){r[a.toLowerCase()]=n}),r}var F=b,fi=g,ci=k.Graph,hi={debugOrdering:li};function li(e){var r=fi.buildLayerMatrix(e),n=new ci({compound:!0,multigraph:!0}).setGraph({});return F.forEach(e.nodes(),function(a){n.setNode(a,{label:a}),n.setParent(a,"layer"+e.node(a).rank)}),F.forEach(e.edges(),function(a){n.setEdge(a.v,a.w,{},a.name)}),F.forEach(r,function(a,i){var o="layer"+i;n.setNode(o,{rank:"same"}),F.reduce(a,function(t,u){return n.setEdge(t,u,{style:"invis"}),u})}),n}var vi="0.8.5",pi={graphlib:k,layout:Fa,debug:hi,util:{time:g.time,notime:g.notime},version:vi};const bi=pr(pi);export{be as c,bi as d};
